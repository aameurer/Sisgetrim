<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<body>
    <!-- Navbar Fragment -->
    <nav th:fragment="navbar"
        class="bg-[#0F172A]/80 backdrop-blur-xl border-b border-white/5 sticky top-0 z-50 transition-all duration-300"
        sec:authorize="isAuthenticated()">
        <div class="max-w-[1440px] mx-auto px-4 lg:px-6">
            <div class="flex justify-between h-20">

                <!-- Esquerda: Logo e Prefeitura -->
                <div class="flex items-center space-x-6">
                    <a href="/dashboard" class="flex items-center space-x-2 hover:opacity-80 transition group">
                        <div
                            class="bg-white/10 p-2 rounded-xl border border-white/10 group-hover:bg-white/20 transition">
                            <img th:src="@{/img/logo.svg}" alt="Sisgetrim" class="h-8 filter brightness-0 invert">
                        </div>
                    </a>
                    <div class="hidden xl:flex items-center space-x-3 pl-6 border-l border-white/10">
                        <div
                            class="h-10 w-10 flex items-center justify-center bg-emerald-500/10 rounded-xl border border-emerald-500/20">
                            <i class="fas fa-shield-halved text-emerald-400 text-xl"></i>
                        </div>
                        <span class="text-[11px] font-black text-white/90 uppercase tracking-[0.2em]">Prefeitura
                            Municipal Teste</span>
                    </div>
                </div>

                <!-- Centro/Direita: Menus e Perfil -->
                <div class="flex-1 flex justify-end items-center space-x-2">
                    <!-- Menus Principais -->
                    <div class="hidden lg:flex items-center space-x-1" x-data="{ openMenu: null }">
                        <!-- Dashboard -->
                        <a href="/dashboard"
                            class="px-4 py-2 text-[10px] font-black uppercase tracking-widest text-white/60 hover:text-emerald-400 flex items-center space-x-2 transition-all group">
                            <i class="fas fa-home text-xs opacity-40 group-hover:opacity-100 transition"></i>
                            <span>Dashboard</span>
                        </a>

                        <!-- Arquivo Dropdown -->
                        <div class="relative">
                            <button @click="openMenu = (openMenu === 'arquivo' ? null : 'arquivo')"
                                @click.away="if(openMenu === 'arquivo') openMenu = null"
                                class="px-4 py-2 text-[10px] font-black uppercase tracking-widest text-white/60 hover:text-emerald-400 flex items-center space-x-2 transition-all group">
                                <i class="fas fa-folder text-xs opacity-40 group-hover:opacity-100 transition"></i>
                                <span>Arquivo</span>
                                <i class="fas fa-chevron-down text-[8px] ml-1 opacity-20 group-hover:opacity-100"></i>
                            </button>
                            <div x-show="openMenu === 'arquivo'" x-transition:enter="transition ease-out duration-200"
                                x-transition:enter-start="opacity-0 scale-95"
                                x-transition:enter-end="opacity-100 scale-100"
                                class="absolute right-0 mt-3 w-48 bg-slate-800/90 backdrop-blur-2xl border border-white/10 rounded-2xl shadow-2xl py-2 z-50 overflow-hidden">
                                <a href="#"
                                    class="block px-4 py-3 text-[11px] font-bold text-slate-300 hover:bg-emerald-500/10 hover:text-emerald-400 transition">Docs</a>
                            </div>
                        </div>

                        <!-- Gerenciamento Dropdown -->
                        <div class="relative">
                            <button @click="openMenu = (openMenu === 'gerenciamento' ? null : 'gerenciamento')"
                                @click.away="if(openMenu === 'gerenciamento') openMenu = null"
                                class="px-4 py-2 text-[10px] font-black uppercase tracking-widest text-white/60 hover:text-emerald-400 flex items-center space-x-2 transition-all group">
                                <i class="fas fa-cog text-xs opacity-40 group-hover:opacity-100 transition"></i>
                                <span>Gerenciamento</span>
                                <i class="fas fa-chevron-down text-[8px] ml-1 opacity-20 group-hover:opacity-100"></i>
                            </button>
                        </div>


                        <!-- Relatórios Dropdown -->
                        <div class="relative">
                            <button @click="openMenu = (openMenu === 'relatorios' ? null : 'relatorios')"
                                @click.away="if(openMenu === 'relatorios') openMenu = null"
                                class="px-4 py-2 text-[10px] font-black uppercase tracking-widest text-white/60 hover:text-emerald-400 flex items-center space-x-2 transition-all group">
                                <i class="fas fa-chart-line text-xs opacity-40 group-hover:opacity-100 transition"></i>
                                <span>Relatórios</span>
                                <i class="fas fa-chevron-down text-[8px] ml-1 opacity-20 group-hover:opacity-100"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Divisor -->
                    <div class="hidden lg:block h-6 w-px bg-white/10 mx-4"></div>

                    <!-- Notificações e Perfil -->
                    <div class="flex items-center space-x-4">
                        <!-- Notificações -->
                        <button class="relative p-2 text-white/40 hover:text-emerald-400 transition group">
                            <i class="fas fa-bell text-lg opacity-60 group-hover:opacity-100 transition"></i>
                            <span
                                class="absolute top-1 right-1 h-4 w-4 bg-rose-500 text-white text-[9px] flex items-center justify-center rounded-full border-2 border-[#0F172A] font-black shadow-sm">1</span>
                        </button>

                        <!-- Perfil Dropdown -->
                        <div class="relative" x-data="{ open: false }">
                            <button @click="open = !open" @click.away="open = false"
                                class="bg-indigo-500/10 px-4 py-2.5 rounded-2xl flex items-center space-x-3 hover:bg-indigo-500/20 transition-all border border-indigo-500/20 group">
                                <div
                                    class="bg-indigo-600 h-7 w-7 rounded-lg flex items-center justify-center text-white shadow-lg shadow-indigo-600/20 overflow-hidden">
                                    <i class="fas fa-user-circle text-sm"
                                        th:if="${#authentication.principal.fotoUrl == null}"></i>
                                    <img th:src="${'/uploads/' + #authentication.principal.fotoUrl}"
                                        th:if="${#authentication.principal.fotoUrl != null}"
                                        class="h-full w-full object-cover">
                                </div>
                                <span class="text-[10px] font-black text-indigo-400 uppercase tracking-widest">Minha
                                    Conta</span>
                            </button>

                            <div x-show="open" x-transition:enter="transition ease-out duration-200"
                                x-transition:enter-start="opacity-0 translate-y-2 scale-95"
                                x-transition:enter-end="opacity-100 translate-y-0 scale-100"
                                class="absolute right-0 mt-3 w-60 bg-slate-800/95 backdrop-blur-2xl border border-white/10 rounded-[2rem] shadow-2xl py-2 z-50 overflow-hidden">

                                <div class="px-6 py-4 border-b border-white/5 mb-1 bg-white/5">
                                    <p class="text-[9px] font-bold text-slate-500 uppercase tracking-[0.2em] mb-1">
                                        Usuário Logado
                                    </p>
                                    <p class="text-sm font-black text-white" sec:authentication="principal.nome">Teste
                                        Fiscal</p>
                                </div>

                                <div class="p-2 space-y-1">
                                    <button
                                        class="w-full flex items-center space-x-3 px-4 py-3 text-[11px] font-bold text-slate-300 hover:bg-white/5 hover:text-white rounded-xl transition">
                                        <i class="fas fa-moon opacity-40"></i>
                                        <span>Modo Escuro</span>
                                    </button>

                                    <a href="/configuracoes"
                                        class="flex items-center space-x-3 px-4 py-3 text-[11px] font-bold text-slate-300 hover:bg-white/5 hover:text-white rounded-xl transition">
                                        <i class="fas fa-cog opacity-40"></i>
                                        <span>Configurações</span>
                                    </a>

                                    <form th:action="@{/logout}" method="post" class="m-0 pt-1 border-t border-white/5">
                                        <button type="submit"
                                            class="w-full flex items-center space-x-3 px-4 py-3 text-[11px] font-black text-rose-500 hover:bg-rose-500/10 rounded-xl transition">
                                            <i class="fas fa-sign-out-alt opacity-70"></i>
                                            <span>Sair do Sistema</span>
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <!-- Mobile Menu Button -->
                        <button class="lg:hidden p-2 text-white/60">
                            <i class="fas fa-bars text-xl"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>

</html>