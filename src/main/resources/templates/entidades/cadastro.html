<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
    layout:decorate="~{dashboard}">

<head>
    <title>Cadastro de Entidade - Sisgetrim</title>
</head>

<body>
    <div layout:fragment="content">
        <!-- Cabeçalho da Página -->
        <div class="mb-6">
            <h1 class="text-2xl font-black text-amazon-text font-outfit uppercase tracking-tight">Cadastro de Entidade
            </h1>
            <p class="text-[10px] font-black text-amazon-primary/60 uppercase tracking-[0.2em] mt-1">Configurações de
                Identificação Jurídica</p>
        </div>

        <!-- Alertas -->
        <div th:if="${sucesso}"
            class="mb-6 p-4 bg-emerald-500/10 border border-emerald-500/20 text-emerald-600 text-xs font-bold rounded-2xl flex items-center shadow-sm">
            <i class="fas fa-check-circle mr-3"></i>
            <span th:text="${sucesso}"></span>
        </div>
        <div th:if="${erro}"
            class="mb-6 p-4 bg-rose-500/10 border border-rose-500/20 text-rose-600 text-xs font-bold rounded-2xl flex items-center shadow-sm">
            <i class="fas fa-exclamation-triangle mr-3"></i>
            <span th:text="${erro}"></span>
        </div>

        <!-- Formulário Estilo CNPJ -->
        <form th:action="@{/entidades/novo}" method="post" th:object="${entidadeRequest}" enctype="multipart/form-data"
            class="max-w-5xl mx-auto space-y-6" th:x-data="|{ 
                logoPreview: '*{logoUrl != null ? '/uploads/entidades/' + logoUrl : null}',
                formatCNPJ(v) {
                    v = v.replace(/\D/g, '');
                    if (v.length > 14) v = v.slice(0, 14);
                    if (v.length <= 2) return v;
                    if (v.length <= 5) return v.replace(/^(\d{2})(\d)/, '$1.$2');
                    if (v.length <= 8) return v.replace(/^(\d{2})(\d{3})(\d)/, '$1.$2.$3');
                    if (v.length <= 12) return v.replace(/^(\d{2})(\d{3})(\d{3})(\d)/, '$1.$2.$3/$4');
                    return v.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d)/, '$1.$2.$3/$4-$5');
                }
            }|">

            <input type="hidden" th:field="*{logoUrl}">

            <div
                class="bg-white/40 backdrop-blur-2xl rounded-[2.5rem] border border-emerald-500/10 shadow-2xl overflow-hidden p-8 lg:p-12">
                <!-- Header Visual CNPJ -->
                <div
                    class="flex flex-col md:flex-row items-center justify-between border-2 border-slate-900/10 p-6 rounded-2xl mb-8 space-y-4 md:space-y-0 relative overflow-hidden">
                    <div class="absolute inset-0 opacity-[0.03] pointer-events-none"
                        style="background-image: url('https://www.transparenttextures.com/patterns/leaf.png');"></div>
                    <div class="flex items-center space-x-6">
                        <div class="relative group">
                            <div
                                class="h-24 w-24 bg-white rounded-2xl border-2 border-dashed border-slate-200 flex items-center justify-center overflow-hidden transition-all group-hover:border-amazon-primary">
                                <template x-if="!logoPreview || logoPreview === 'null'">
                                    <i class="fas fa-landmark text-3xl text-slate-300"></i>
                                </template>
                                <template x-if="logoPreview && logoPreview !== 'null'">
                                    <img :src="logoPreview" class="h-full w-full object-contain">
                                </template>
                                <input type="file" name="logo" class="absolute inset-0 opacity-0 cursor-pointer"
                                    @change="const file = $event.target.files[0]; if (file) { const reader = new FileReader(); reader.onload = (e) => { logoPreview = e.target.result }; reader.readAsDataURL(file) }">
                            </div>
                            <span
                                class="absolute -bottom-2 -right-2 bg-amazon-primary text-white text-[8px] font-black px-2 py-1 rounded-full uppercase tracking-tighter">LOGO</span>
                        </div>
                        <div>
                            <h2 class="text-xl font-black text-slate-800 uppercase tracking-tighter">República
                                Federativa do Brasil</h2>
                            <p class="text-[11px] font-bold text-slate-500 uppercase tracking-widest mt-1">Cadastro
                                Nacional da Pessoa Jurídica</p>
                        </div>
                    </div>
                    <div class="text-center md:text-right">
                        <p class="text-[9px] font-black text-slate-400 uppercase tracking-widest mb-1">Comprovante de
                            Inscrição e de Situação Cadastral</p>
                        <div class="inline-block bg-slate-900/5 px-4 py-2 rounded-xl text-slate-800 font-black text-lg">
                            ENTIDADE</div>
                    </div>
                </div>

                <!-- Campos Grid - Simulando o layout do documento -->
                <div
                    class="grid grid-cols-12 gap-px bg-slate-900/10 border-2 border-slate-900/10 rounded-2xl overflow-hidden shadow-inner">
                    <!-- Linha 1 -->
                    <div class="col-span-12 md:col-span-4 bg-white p-4">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Número
                            de Inscrição</label>
                        <input type="text" id="cnpjInput" th:field="*{cnpj}" placeholder="00.000.000/0000-00" required
                            x-init="$el.value = formatCNPJ($el.value)" x-on:input="$el.value = formatCNPJ($el.value)"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent placeholder-slate-200">
                    </div>
                    <div class="col-span-12 md:col-span-4 bg-white p-4 border-l border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Tipo</label>
                        <input type="text" th:field="*{tipoEstabelecimento}" placeholder="MATRIZ"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-4 bg-white p-4 border-l border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Data
                            de Abertura</label>
                        <input type="date" th:field="*{dataAbertura}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent">
                    </div>

                    <!-- Linha 2 -->
                    <div class="col-span-12 bg-white p-4 border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Nome
                            Empresarial</label>
                        <input type="text" th:field="*{nomeEmpresarial}" placeholder="MUNICIPIO DE..." required
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 3 -->
                    <div class="col-span-12 md:col-span-9 bg-white p-4 border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Título
                            do Estabelecimento (Nome de Fantasia)</label>
                        <input type="text" th:field="*{nomeFantasia}" placeholder="PREFEITURA DE..."
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-3 bg-white p-4 border-l border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Porte</label>
                        <input type="text" th:field="*{porte}" placeholder="DEMAIS"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 4 (CNAE Principal) -->
                    <div class="col-span-12 bg-white p-4 border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Código
                            e Descrição da Atividade Econômica Principal</label>
                        <input type="text" th:field="*{cnaePrincipal}"
                            placeholder="84.11-6-00 - Administração pública em geral"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 5 (CNAE Secundário) -->
                    <div class="col-span-12 bg-white p-4 border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Código
                            e Descrição das Atividades Econômicas Secundárias</label>
                        <input type="text" th:field="*{cnaeSecundario}" placeholder="Não informada"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 6 (Natureza) -->
                    <div class="col-span-12 bg-white p-4 border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Código
                            e Descrição da Natureza Jurídica</label>
                        <input type="text" th:field="*{naturezaJuridica}" placeholder="124-4 - Município"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 7 (Endereço Parte 1) -->
                    <div class="col-span-12 md:col-span-6 bg-white p-4 border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Logradouro</label>
                        <input type="text" th:field="*{logradouro}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-2 bg-white p-4 border-l border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Número</label>
                        <input type="text" th:field="*{numero}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-4 bg-white p-4 border-l border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Complemento</label>
                        <input type="text" th:field="*{complemento}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 8 (Endereço Parte 2) -->
                    <div class="col-span-12 md:col-span-3 bg-white p-4 border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">CEP</label>
                        <input type="text" th:field="*{cep}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-3 bg-white p-4 border-l border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Bairro/Distrito</label>
                        <input type="text" th:field="*{bairro}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-4 bg-white p-4 border-l border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Município</label>
                        <input type="text" th:field="*{municipio}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-2 bg-white p-4 border-l border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">UF</label>
                        <input type="text" th:field="*{uf}" maxlength="2"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 9 (Contato) -->
                    <div class="col-span-12 md:col-span-6 bg-white p-4 border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Endereço
                            Eletrônico</label>
                        <input type="email" th:field="*{email}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-6 bg-white p-4 border-l border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Telefone</label>
                        <input type="text" th:field="*{telefone}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 10 (EFR) -->
                    <div class="col-span-12 bg-white p-4 border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Ente
                            Federativo Responsável (EFR)</label>
                        <input type="text" th:field="*{enteFederativo}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 11 (Situação Cadastral) -->
                    <div class="col-span-12 md:col-span-8 bg-white p-4 border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Situação
                            Cadastral</label>
                        <select th:field="*{situacaoCadastral}"
                            class="w-full text-sm font-black text-emerald-600 outline-none p-0 bg-transparent uppercase cursor-pointer appearance-none">
                            <option value="ATIVA" class="text-emerald-600 font-black">ATIVA</option>
                            <option value="BAIXADA" class="text-rose-600 font-black">BAIXADA (Desativada)</option>
                            <option value="SUSPENSA" class="text-amber-600 font-black">SUSPENSA</option>
                            <option value="INAPTA" class="text-slate-600 font-black">INAPTA</option>
                            <option value="NULA" class="text-slate-400 font-black">NULA</option>
                        </select>
                    </div>
                    <div class="col-span-12 md:col-span-4 bg-white p-4 border-l border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Data
                            da Situação Cadastral</label>
                        <input type="date" th:field="*{dataSituacaoCadastral}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent">
                    </div>

                    <!-- Linha 12 (Motivo Situação) -->
                    <div class="col-span-12 bg-white p-4 border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Motivo
                            de Situação Cadastral</label>
                        <input type="text" th:field="*{motivoSituacaoCadastral}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>

                    <!-- Linha 13 (Situação Especial) -->
                    <div class="col-span-12 md:col-span-8 bg-white p-4 border-t border-slate-900/5">
                        <label
                            class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Situação
                            Especial</label>
                        <input type="text" th:field="*{situacaoEspecial}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent uppercase">
                    </div>
                    <div class="col-span-12 md:col-span-4 bg-white p-4 border-l border-t border-slate-900/5">
                        <label class="block text-[9px] font-black text-slate-400 uppercase tracking-tighter mb-1">Data
                            da Situação Especial</label>
                        <input type="date" th:field="*{dataSituacaoEspecial}"
                            class="w-full text-sm font-black text-slate-800 outline-none p-0 bg-transparent">
                    </div>
                </div>

                <!-- Footer Ações -->
                <div class="mt-12 flex flex-wrap gap-4 justify-end">
                    <a th:href="@{/entidades}"
                        class="bg-slate-100 text-slate-600 font-black uppercase tracking-[0.2em] px-8 py-4 rounded-2xl hover:bg-slate-200 transition-all duration-300 flex items-center group active:scale-95">
                        <i class="fas fa-times mr-3 opacity-40 group-hover:opacity-100 transition-opacity"></i>
                        <span>Fechar</span>
                    </a>

                    <button type="button" onclick="window.location.reload()"
                        class="bg-slate-100 text-slate-600 font-black uppercase tracking-[0.2em] px-8 py-4 rounded-2xl hover:bg-slate-200 transition-all duration-300 flex items-center group active:scale-95">
                        <i class="fas fa-eraser mr-3 opacity-40 group-hover:opacity-100 transition-opacity"></i>
                        <span>Limpar</span>
                    </button>

                    <button type="submit"
                        class="bg-amazon-primary text-white font-black uppercase tracking-[0.2em] px-12 py-5 rounded-2xl shadow-lg shadow-emerald-500/20 hover:bg-amazon-sidebar hover:scale-[1.02] active:scale-95 transition-all duration-300 flex items-center group">
                        <span>Gravar e Retornar</span>
                        <i class="fas fa-save ml-3 opacity-60 group-hover:opacity-100 transition-opacity"></i>
                    </button>
                </div>
            </div>
        </form>
    </div>
</body>

</html>